1. roughly can divide to `rearrange`, `reduce` and `repeat`

see https://zhuanlan.zhihu.com/p/372692913 for details